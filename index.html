<!DOCTYPE html>
<html>
<head>
	<title>Event Registration Form</title>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
	<style>
		body {
			display: flex;
			align-items: center;
			flex-direction: column;
			justify-content: center;
			height: 100vh;
			background: url('/background.png'); /* light desert color */
			font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			direction: rtl;
			/* text-align: center; */
			color: #8F6D56;
		}
		h1{
			font-size: 70px;
			text-align: center;
		}
		p{
			text-align: center;
			font-size: 50px;
		}
		#date{
			margin-top: 0px;
		}
		#invitation{
			display: flex;
			width: 100%;
			align-items: center;
			flex-direction: column;
			gap: 50px;
		}
		.amountLabel{
			font-size: 50px;
			/* text-align: right; */
		}
		#amount{
			width: 30%;
			background-color: transparent;
			border: transparent;
			border-bottom: 1px solid #8F6D56;
			color: #8F6D56;
		}
		.layout{
			width: 73%;
			display: flex;
			align-items: center;
			justify-content: space-between;
		}
		.btn{
			width: 300px;
			height: 90px;
			font-size: 45px;
			border-radius: 40px;
			border: transparent;
		}
		.btn__comming{
			background-color: #cfe885;
		}
		.btn__notComming{
			background-color: #ffba98;
		}
		#location{
			font-size: 40px;
		}
		.map{
			display: flex;
			align-items: center;
		}


	</style>
</head>
<body>
	<h1> שלום <span id="name"></span></h1>
	<p> נשמח לאישור הגעתך לחתונה של<br/> תמר וגלי </p>
	<p id="date"><b> בתאריך 22-6-23</b></p>
	<form  id="invitation">
		<div class="layout">
			<label class="amountLabel" for="amount">כמה תהיו?</label>
			<select id="amount">
				<option selected>0</option>
				<option>1</option>
				<option>2</option>
				<option>3</option>
				<option>4</option>
				<option>5</option>
				<option>6</option>
				<option>7</option>
				<option>8</option>
			</select>
		</div>

		<div class="layout">
			<button name="coming" type="submit" class="btn btn__comming">מגיעים</button>
			<button name="notComing" type="submit" class="btn btn__notComming">לא מגיעים</button>
		</div>

		<div>
			<p id="location">אהובת הספן, יונה הנביא 2 אשדוד</p>
			<div class="map">
				<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3390.409546558001!2d34.63895917617039!3d31.813838232583414!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x1502a3a074cb73cb%3A0x8500d0e5ae6a25de!2z15DXlNeV15HXqiDXlNeh16TXnw!5e0!3m2!1sen!2sil!4v1685092426865!5m2!1sen!2sil" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
			</div>
		</div>
	</form>
	<script>
		  	const queryString = window.location.search;
			const urlParams = new URLSearchParams(queryString);
			const name = urlParams.get('name');
			const phone = urlParams.get('phone');
			document.getElementById('name').innerHTML = name || 'לך';
			const form = document.getElementById('invitation');
			$("form").submit(function (e) {
				e.preventDefault()
				let btn = $(this).find("button[type=submit]:focus" );
				let btnName = btn.attr('name');
				let input = $("<button>")
				if( btnName.valueOf() === 'coming'){
					isComing = true;
				} else {
					isComing = false;
				}
				sendData()
			});
			function sendData() {
				const amount = document.getElementById('amount').value
				let attendenceName = name;
				const payload = {name:attendenceName , amount: amount, phone:phone , isComing: isComing }
				console.log(payload);
				if (phone && amount && name) {
					executeRequest(payload);
				}
				const isComming = document.getElementById('is');
			}

			function executeRequest(payload) {
				fetch("https://vivacious-tweed-jacket-jay.cyclic.app/newArrival", {
					method: "POST",
					body: JSON.stringify(payload),
					headers: {
						"Content-type": "application/json; charset=UTF-8"
					}
					}).then((res)=> {
						console.log(res);
					}).catch((err) => {
						console.log(err);
					});
			}
			
	</script>
</body>
</html>
